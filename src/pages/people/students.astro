---
import BaseLayout from "../../layouts/BaseLayout.astro";
import type { MarkdownInstance } from "astro";

type FM = Record<string, any>;

const modules = import.meta.glob<MarkdownInstance<FM>>("/src/content/people/professor.md");
const loaded = await Promise.all(Object.values(modules).map((fn) => fn()));
const page = loaded[0];

if (!page) throw new Error("Professor markdown not found: /src/content/people/professor.md");

const { Content, frontmatter } = page;

const name = frontmatter.name ?? "";
const role = frontmatter.role ?? frontmatter.position ?? "";
const email = frontmatter.email ?? "";
const photo = frontmatter.photo ?? "";
const office = frontmatter.office ?? "";
---

<BaseLayout title="Professor">
  <main style="max-width: 900px; margin: 0 auto; padding: 48px 16px;">
    <h1>Professor</h1>

    <section style="display:flex; gap:24px; align-items:flex-start; margin-top:24px;">
      {photo && (
        <img
          src={photo}
          alt={name}
          style="width:220px; height:220px; object-fit:cover; border-radius:12px;"
          loading="lazy"
        />
      )}

      <div>
        {name && <h2 style="margin:0 0 8px 0;">{name}</h2>}
        {role && <div style="opacity:.8; margin-bottom:12px;">{role}</div>}

        <div style="display:grid; gap:6px;">
          {email && (
            <div>
              <b>Email:</b> {email}
            </div>
          )}
          {office && (
            <div>
              <b>Office:</b> {office}
            </div>
          )}
        </div>
      </div>
    </section>

    <section style="margin-top:24px; line-height:1.7;">
      <Content />
    </section>
  </main>
</BaseLayout>
