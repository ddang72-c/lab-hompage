---
import SectionLayout from "../../../layouts/SectionLayout.astro";
import type { MarkdownInstance } from "astro";

const nav = [
  { label: "News", href: "/board/news/" },
  { label: "Gallery", href: "/board/gallery/" },
];

type FM = Record<string, any>;
const modules = import.meta.glob<MarkdownInstance<FM>>("/src/content/board/news/*.md");

export async function getStaticPaths() {
  return Object.keys(modules).map((path) => {
    const slug = path.split("/").pop()?.replace(/\.md$/, "") ?? path;
    return { params: { slug }, props: { path } };
  });
}

const { path } = Astro.props as { path: string };
const entry = await modules[path]();
const { Content, frontmatter } = entry;

const title = frontmatter?.title ?? "News";
const dateStr = (frontmatter?.date ?? frontmatter?.published ?? "").toString();
const when = dateStr ? dateStr.slice(0, 10) : "";
---

<SectionLayout title={title} sectionLabel="BOARD" navItems={nav} heroSrc="/images/sub-hero.jpg">
  <h1>{title}</h1>
  {when && <div class="muted" style="margin-top:6px;">{when}</div>}

  <div style="margin-top:18px; line-height:1.8;">
    <Content />
  </div>

  <div style="margin-top:22px;">
    <a class="btn" href="/board/news/">Back to list</a>
  </div>
</SectionLayout>
